{% extends 'index.html' %}


{% block content %}
<div class="text-center my-5">
    <img class="img-fluid rounded-circle mb-4" src="https://dummyimage.com/150x150/6c757d/dee2e6.jpg" alt="..." />
    <h1 class="text-white fs-3 fw-bolder">{{ state.name }} 지역</h1>
    <p class="text-white-50 mb-0"></p>
</div>
{% endblock %}


{% block nav %}
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
        <a class="navbar-brand" href="http://127.0.0.1:8000/park/home">HOME</a>
        <a class="navbar-brand" href="http://127.0.0.1:8000/park/park_list/">공원</a>
        <a class="navbar-brand" href="http://127.0.0.1:8000/loc/map/{{state.id}}">MAP</a>
        <a class="navbar-brand" href="#!">CONTACT</a>
    </div>
</nav>
{% endblock %}


{% block map %}
<div class="jumbotron">
    <div class="container text-center">
        <div id="map" style="width:500px; height:400px; margin:0 auto;"></div>
    </div>
</div>
<script src="http://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="http://dapi.kakao.com/v2/maps/sdk.js?appkey=da146a2a6ff6a54903c1d2a7caecd1c7"></script>
<script>

    navigator.geolocation.getCurrentPosition((position) => {
        const latitude = {{ state.lat }};
        const longitude = {{ state.lng }};

        var container = document.getElementById('map');
        var options = {
            center: new kakao.maps.LatLng(latitude, longitude),
            level: {{size}}
        };

        var map = new kakao.maps.Map(container, options);

        var markerPosition = new kakao.maps.LatLng(latitude, longitude);

        var marker = new kakao.maps.Marker({
            position: markerPosition
        });

        marker.setMap(map);

        $.ajax({
            url: '/loc/state/',
            data: {
                'park_latitude': latitude, 'park_longitude': longitude
            },
            success: function (res) {
                for (var i = 0; i < res.length; i++) {
                    var marker = new kakao.maps.Marker({
                        map: map, // 마커를 표시할 지도
                        position: new kakao.maps.LatLng(res[i].park_latitude, res[i].park_longitude),
                        title: res[i].title,
                    });
                }
            }
        });
    });
</script>
{% endblock %}